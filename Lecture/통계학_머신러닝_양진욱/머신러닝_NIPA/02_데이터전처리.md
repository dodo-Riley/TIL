# 2. 데이터 전처리

## 1) 머신러닝을 위한 데이터 전처리 이해

- 머신러닝의 과정
    - 데이터 수집 : 크롤링 도는 DB를 통하여 데이터를 수집
    - 데이터 분석 및 전처리 : 수집한 데이터를 분석하고 머신러닝에 사용할 형태로 전처리
    - 머신러닝 학습 : 모델을 사용하여 데이터를 학습
    - 머신러닝 평가 : 학습된 모델을 평가용 데이터를 사용해 평가

- 데이터 전처리의 역할
    - 머신러닝의 입력 형태로 데이터 변환(특성 엔지니어링)
        - 대부분의 머신러닝 모델은 숫자 데이터를 입력받지만, 실제 데이터는 다양한 형태로 존재하기 때문에 변환이 필요
    - 결측값 및 이상치를 처리하여 데이터 정제
        - 모델의 학습에 악영향을 주는 데이터를 사전에 처리할 필요
    - 학습용 및 평가용 데이터 분리
        - 모델의 성능이 원하는만큼 도달했는지 확인이 필요

## 2) 범주형 자료 전처리

- 대표적인 범주형 자료 변환 방식
    - 명목형 자료
        - 수치 매핑 : 범주를 일정한 숫자로 매핑(남자는 1, 여자는 0)
        - 더미 변수 : 각 범주에 속하는 데이터가 존재하면 1 아니면 0으로 새로운 더미 변수를 만들어 구분
    - 순서형 자료
        - 수치 매핑 : 수치 간 크기 차리를 임의로 설정 가능

## 3) 수치형 자료 전처리

- 대표적인 수치형 자료 변환 방식
    - 스케일링(scailing) : 변수 간의 단위 차이 등이 존재할 때, 값의 범위 및 크기를 변환
        - 정규화(normalization) : $X'={(X-X_{min})\over(X_{max}-X_{min})}$
        - 표준화(standardization) : $X'={(X-\bar{X})\over\sigma}$
    - 범주화 : 변수의 값보다 범주가 중요한 경우 사용(평균을 기준으로 합/불합 나누는 경우 등)
    

## 4) 데이터 정제 및 분리

- 결측값(missing value) 처리
    - 일반적인 머신러닝 모델의 입력값으로 결측값(null, NaN, None 등)을 사용할 수 없으므로 처리 필요
    - 대표적인 처리 방식
        - 결측값이 존재하는 샘플 삭제
        - 결측값이 대부분인 변수 삭제
        - 결측값을 다른 값으로 대체
        
- 이상치(outlier) 처리
    - 이상치는 모델 성능의 저하를 가져오므로 제거가 필요
    - 단, 해당 값이 이상치인지 판단하는 기준이 중요함
    - 대표적인 판단 방식
        - 통계량(카이제곱검정, IQR 등)을 사용해 판단
        - 데이터 분포를 확인하여 직접 판단
        - 머신러닝 기법을 사용해 이상치 분류
        
- 데이터 분리
    - 모델의 평가를 위해 train/test dataset의 분리가 필요
    - 일반적으로 train:test=7:3, 8:2 등의 비율로 분리
    - 지도학습의 경우 feature/label data의 분리가 추가적으로 필요
        - feature data : label을 예측하기 위한 입력 값
        - label data : 예측해야 할 대상이 되는 데이터
        - 예 : titanic dataset에서 생존율은 label data, 나이, 가족 정보, 객실 등급 등은 feature data