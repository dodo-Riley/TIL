# 4. 데이터 분석 맛보기_유튜브 랭킹 데이터 수집과 시각화

- 유튜브 랭킹 100위까지 데이터 크롤링(음악 차트 크롤링과 같은 과정이므로 주석 생략)
    
    ```python
    from selenium import webdriver
    from selenium.webdriver.chrome.service import Service
    from bs4 import BeautifulSoup
    import pandas as pd
    import numpy as np
    
    service = Service('../chromedriver/chromedriver.exe')
    driver = webdriver.Chrome(service=service)
    
    url = 'http://youtube-rank.com/board/bbs/board.php?bo_table=youtube'
    driver.get(url)
    html = driver.page_source
    soup = BeautifulSoup(html, 'html.parser')
    
    total_data = soup.select('form>table>tbody>tr')
    len(total_data)
    
    data_list = []
    
    for data in total_data:
        category = data.select('p.category')[0].text.strip()
        name = data.select('h1 > a')[0].text.strip()
        subscribe = data.select('td.subscriber_cnt')[0].text
        total_view = data.select('td.view_cnt')[0].text
        video = data.select('td.video_cnt')[0].text
        view = data.select('td.hit > strong')[0].text
        data_list.append([category,name,subscribe,total_view,video,view])
    
    columns = ['카테고리','채널명','구독자 수','총 조회수','영상 수','평균 조회수']
    pd_data = pd.DataFrame(data_list, columns=columns)
    pd_data.to_excel('./youtube_rank_class.xlsx', index=False)
    ```
    
- 유튜브 랭킹 100위 이후까지 크롤링
    - 100위 단위로 페이지가 나뉘어있으므로 페이지에 따라 위의 과정을 반복하도록 하면 된다.
    
    ```python
    # 원하는 페이지까지 크롤링하기
    from selenium import webdriver
    from selenium.webdriver.chrome.service import Service
    from bs4 import BeautifulSoup
    import pandas as pd
    import numpy as np
    import time
    
    service = Service('../chromedriver/chromedriver.exe')
    driver = webdriver.Chrome(service=service)
    
    data_list = []
    
    for page in range(1,11): # 10페이지까지 크롤링 반복
        url = f'http://youtube-rank.com/board/bbs/board.php?bo_table=youtube&page={page}' # 주소에서 페이지 숫자만 다르므로 포매팅을 이용    
    		driver.get(url)
        time.sleep(2) # 웹 페이지가 로딩되기 전에 html을 다운하는 상황을 방지하기 위해 시간 부여
        html = driver.page_source
        soup = BeautifulSoup(html, 'html.parser')
    
        total_data = soup.select('form>table>tbody>tr')
    
        for data in total_data:
            category = data.select('p.category')[0].text.strip()
            name = data.select('h1 > a')[0].text.strip()
            subscribe = data.select('td.subscriber_cnt')[0].text
            total_view = data.select('td.view_cnt')[0].text
            video = data.select('td.video_cnt')[0].text
            view = data.select('td.hit > strong')[0].text
            data_list.append([category,name,subscribe,total_view,video,view])
    
    columns = ['카테고리','채널명','구독자 수','총 조회수','영상 수','평균 조회수']
    pd_data = pd.DataFrame(data_list, columns=columns)
    pd_data.to_excel('./youtube_rank_page_class.xlsx', index=False)
    ```
    
- 크롤링한 데이터 시각화하기